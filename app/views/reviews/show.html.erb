<div class="container mx-auto px-4 py-8">
  <div class="bg-white shadow-md rounded-lg p-6">
    <!-- Course Name and Link -->
    <h1 class="text-3xl font-bold mb-2">
      <%= link_to @review.course.name, course_path(@review.course), class: "text-blue-600 hover:underline" %>
    </h1>
    <p class="text-gray-600 mb-4">
      Posted by <%= @review.user.name %> on <%= @review.created_at.strftime("%Y-%m-%d") %>
    </p>

    <hr class="my-4">

    <!-- Review Title -->
    <h2 class="text-2xl font-semibold mb-4"><%= @review.title %></h2>

    <!-- Star Ratings -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div class="flex items-center">
        <span class="font-semibold w-24">Overall:</span>
        <span class="text-yellow-500"><%= "â˜…" * @review.rating %><%= "â˜†" * (5 - @review.rating) %></span>
      </div>
      <div class="flex items-center">
        <span class="font-semibold w-24">Difficulty:</span>
        <span class="text-yellow-500"><%= "â˜…" * @review.difficulty if @review.difficulty.present? %><%= "â˜†" * (5 - @review.difficulty) if @review.difficulty.present? %></span>
      </div>
      <div class="flex items-center">
        <span class="font-semibold w-24">Workload:</span>
        <span class="text-yellow-500"><%= "â˜…" * @review.workload if @review.workload.present? %><%= "â˜†" * (5 - @review.workload) if @review.workload.present? %></span>
      </div>
    </div>

    <!-- Other Details -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 text-gray-700 mb-6">
      <p><strong class="font-semibold">Semester Taken:</strong> <%= @review.semester_taken || "N/A" %></p>
      <p><strong class="font-semibold">Year Taken:</strong> <%= @review.year_taken || "N/A" %></p>
      <p><strong class="font-semibold">Attendance Required:</strong> <%= @review.attendance_required.present? ? (@review.attendance_required ? 'Yes' : 'No') : "N/A" %></p>
    </div>


    <!-- Main Content Sections -->
    <div class="space-y-6">
      <div>
        <h3 class="text-xl font-semibold border-b pb-2 mb-2">Review Content</h3>
        <div class="prose max-w-none">
          <%= simple_format(@review.content) %>
        </div>
      </div>

      <% if @review.exam_info.present? %>
        <div>
          <h3 class="text-xl font-semibold border-b pb-2 mb-2">Exam Info</h3>
          <div class="prose max-w-none">
            <%= simple_format(@review.exam_info) %>
          </div>
        </div>
      <% end %>

      <% if @review.tips.present? %>
        <div>
          <h3 class="text-xl font-semibold border-b pb-2 mb-2">Tips</h3>
          <div class="prose max-w-none">
            <%= simple_format(@review.tips) %>
          </div>
        </div>
      <% end %>
    </div>

    <hr class="my-6">

    <!-- Action Buttons -->
    <div class="flex items-center justify-between">
      <!-- Reaction Buttons -->
      <div class="flex items-center space-x-2">
        <span class="text-gray-700">Was this review helpful?</span>
        <%= form_with(model: [@review, @review.review_reactions.build], url: review_review_reactions_path(@review), method: :post, class: "contents") do |form| %>
          <%= form.hidden_field :reaction_type, value: 'helpful' %>
          <%= form.button "ðŸ‘ Helpful (#{@review.review_reactions.where(reaction_type: 'helpful').count})", class: "bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out" %>
        <% end %>
        <%= form_with(model: [@review, @review.review_reactions.build], url: review_review_reactions_path(@review), method: :post, class: "contents") do |form| %>
          <%= form.hidden_field :reaction_type, value: 'not_helpful' %>
          <%= form.button "ðŸ‘Ž Not Helpful (#{@review.review_reactions.where(reaction_type: 'not_helpful').count})", class: "bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out" %>
        <% end %>
      </div>

      <!-- Edit/Delete Buttons for Author -->
      <% if current_user == @review.user %>
        <div class="flex items-center space-x-2">
          <%= link_to 'Edit', edit_review_path(@review), class: "bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded" %>
          <%= button_to 'Delete', review_path(@review), method: :delete, data: { confirm: 'Are you sure you want to delete this review?' }, class: "bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="mt-4">
    <%= link_to 'Back to Course', course_path(@review.course), class: "text-blue-600 hover:underline" %>
  </div>
</div>